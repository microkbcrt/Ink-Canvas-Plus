<Window Name="window" x:Class="InkCanvasPlus.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:ui="http://schemas.inkore.net/lib/ui/wpf/modern"
        xmlns:helpers="clr-namespace:InkCanvasPlus.Helpers"
        xmlns:controls="clr-namespace:InkCanvasPlus.Controls"
        mc:Ignorable="d"
        AllowsTransparency="True"
        WindowStyle="None"
        ResizeMode="NoResize"
        WindowState="Maximized"
        Loaded="Window_Loaded"
        Background="Transparent"
        ShowInTaskbar="False"
        Title="Ink Canvas 画板"
        Topmost="True"
        KeyDown="Window_KeyDown"
        Closing="Window_Closing"
        Closed="Window_Closed"
        PreviewKeyDown="Main_Grid_PreviewKeyDown"
        Height="10000" Width="1000"
        FontFamily="Microsoft YaHei UI"
        MouseWheel="Window_MouseWheel"
        Foreground="Black"
        Stylus.IsPressAndHoldEnabled="False">
    <!--资源中添加命令-->
    <Window.Resources>
        <helpers:VisibilityConverter x:Key="VisibilityConverter" />
        <helpers:IsEnabledToOpacityConverter x:Key="IsEnabledToOpacityConverter" />
        <RoutedUICommand x:Key="KeyExit" Text=" " />
        <RoutedUICommand x:Key="back_HotKey_Command" Text=" " />
        <RoutedUICommand x:Key="HotKey_Capture" Text=" " />
        <RoutedUICommand x:Key="HotKey_Hide" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToDrawTool" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToSelect" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToEraser" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToPen1" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToPen2" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToPen3" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToPen4" Text=" " />
        <RoutedUICommand x:Key="HotKey_ChangeToPen5" Text=" " />
        <RoutedUICommand x:Key="HotKey_DrawLine" Text=" " />
    </Window.Resources>
    <!--输入命令绑定-->
    <Window.InputBindings>
        <KeyBinding Gesture="Shift+Esc" Command="{StaticResource KeyExit}" />
        <KeyBinding Modifiers="Control" Key="Z" Command="{StaticResource back_HotKey_Command}" />
        <KeyBinding Modifiers="Alt" Key="S" Command="{StaticResource HotKey_ChangeToSelect}" />
        <KeyBinding Modifiers="Alt" Key="D" Command="{StaticResource HotKey_ChangeToDrawTool}" />
        <KeyBinding Modifiers="Alt" Key="E" Command="{StaticResource HotKey_ChangeToEraser}" />
        <KeyBinding Modifiers="Alt" Key="C" Command="{StaticResource HotKey_Capture}" />
        <KeyBinding Modifiers="Alt" Key="D1" Command="{StaticResource HotKey_ChangeToPen1}" />
        <KeyBinding Modifiers="Alt" Key="D2" Command="{StaticResource HotKey_ChangeToPen2}" />
        <KeyBinding Modifiers="Alt" Key="D3" Command="{StaticResource HotKey_ChangeToPen3}" />
        <KeyBinding Modifiers="Alt" Key="D4" Command="{StaticResource HotKey_ChangeToPen4}" />
        <KeyBinding Modifiers="Alt" Key="D5" Command="{StaticResource HotKey_ChangeToPen5}" />
        <KeyBinding Modifiers="Alt" Key="V" Command="{StaticResource HotKey_Hide}" />
        <KeyBinding Modifiers="Alt" Key="L" Command="{StaticResource HotKey_DrawLine}" />
    </Window.InputBindings>
    <!--命令执行方法绑定-->
    <Window.CommandBindings>
        <CommandBinding Command="{StaticResource back_HotKey_Command}"
                        CanExecute="CommandBinding_CanExecute"
                        Executed="back_HotKey" />
        <CommandBinding Command="{StaticResource KeyExit}"
                        CanExecute="CommandBinding_CanExecute"
                        Executed="KeyExit" />
        <CommandBinding Command="{StaticResource HotKey_ChangeToDrawTool}"
                        CanExecute="CommandBinding_CanExecute"
                        Executed="KeyChangeToDrawTool" />
        <CommandBinding Command="{StaticResource HotKey_ChangeToSelect}"
                        CanExecute="CommandBinding_CanExecute"
                        Executed="KeyChangeToSelect" />
        <CommandBinding Command="{StaticResource HotKey_ChangeToEraser}"
                        CanExecute="CommandBinding_CanExecute"
                        Executed="KeyChangeToEraser" />
        <CommandBinding Command="{StaticResource HotKey_Capture}"
                        CanExecute="CommandBinding_CanExecute"
                        Executed="KeyCapture" />
        <CommandBinding Command="{StaticResource HotKey_Hide}"
                        CanExecute="CommandBinding_CanExecute"
                        Executed="KeyHide" />
        <CommandBinding Command="{StaticResource HotKey_DrawLine}"
                        CanExecute="CommandBinding_CanExecute"
                        Executed="KeyDrawLine" />
    </Window.CommandBindings>
    <Grid x:Name="Main_Grid" Background="#01FFFFFF">
        <Grid Name="GridBackgroundCoverHolder">
            <Grid Name="GridBackgroundCover" Visibility="Collapsed" Background="#1F1F1F" />
        </Grid>
        <Canvas Name="Canvas" />
        <Label Name="Label" Visibility="Collapsed" Foreground="Gray" Content="0" />
        <InkCanvas x:Name="inkCanvas" Background="Transparent" Cursor="Pen" ForceCursor="False"
                   TouchUp="Main_Grid_TouchUp" TouchDown="Main_Grid_TouchDown"
                   TouchMove="inkCanvas_TouchMove"
                   ManipulationDelta="Main_Grid_ManipulationDelta"
                   ManipulationCompleted="Main_Grid_ManipulationCompleted"
                   ManipulationInertiaStarting="inkCanvas_ManipulationInertiaStarting"
                   IsManipulationEnabled="True"
                   EditingModeChanged="inkCanvas_EditingModeChanged"
                   PreviewTouchDown="inkCanvas_PreviewTouchDown"
                   PreviewTouchUp="inkCanvas_PreviewTouchUp"
                   MouseDown="inkCanvas_MouseDown"
                   MouseMove="inkCanvas_MouseMove"
                   MouseUp="inkCanvas_MouseUp"
                   ManipulationStarting="inkCanvas_ManipulationStarting"
                   SelectionChanged="inkCanvas_SelectionChanged"
                   StrokeCollected="inkCanvas_StrokeCollected">
            <!--<InkCanvas.DefaultDrawingAttributes>
                <DrawingAttributes StylusTip="Ellipse" Height="8" Width="4" IgnorePressure="False" FitToCurve="True">
                    <DrawingAttributes.StylusTipTransform>
                        <Matrix M11="1" M12="1.5" M21="2.2" M22="1" />
                    </DrawingAttributes.StylusTipTransform>
                </DrawingAttributes>
            </InkCanvas.DefaultDrawingAttributes>-->
        </InkCanvas>
        <Grid Visibility="{Binding ElementName=inkCanvas, Path=Visibility}">
            <Grid Name="GridInkCanvasSelectionCover"
                  MouseDown="GridInkCanvasSelectionCover_MouseDown"
                  MouseUp="GridInkCanvasSelectionCover_MouseUp"
                  IsManipulationEnabled="True"
                  ManipulationStarting="GridInkCanvasSelectionCover_ManipulationStarting"
                  ManipulationCompleted="GridInkCanvasSelectionCover_ManipulationCompleted"
                  ManipulationDelta="GridInkCanvasSelectionCover_ManipulationDelta"
                  PreviewTouchDown="GridInkCanvasSelectionCover_PreviewTouchDown"
                  PreviewTouchUp="GridInkCanvasSelectionCover_PreviewTouchUp"
                  TouchDown="GridInkCanvasSelectionCover_TouchDown"
                  TouchUp="GridInkCanvasSelectionCover_TouchUp"
                  Background="#01FFFFFF" Opacity="0.01" Visibility="Visible" />
            <Border Name="BorderStrokeSelectionControl"
                    HorizontalAlignment="Left" VerticalAlignment="Top" Margin="100,900,0,0"
                    CornerRadius="18" Height="80"
                    Background="{DynamicResource FloatBarBackground}" Visibility="{Binding ElementName=GridInkCanvasSelectionCover, Path=Visibility}"
                    BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                <Viewbox Margin="0,-2.5">
                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="10" Height="60">
                        <Border Name="BorderStrokeSelectionClone" Margin="0,2,-9,2" Background="Transparent" CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}"
                                Width="40" MouseDown="Border_MouseDown" MouseUp="BorderStrokeSelectionClone_MouseUp">
                            <ui:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="5">
                                <ui:SymbolIcon Symbol="Copy" Foreground="{DynamicResource FloatBarForeground}" />
                                <TextBlock Text="克隆" FontSize="10" Foreground="{DynamicResource FloatBarForeground}" />
                            </ui:SimpleStackPanel>
                        </Border>
                        <Border Name="BorderStrokeSelectionCloneToNewBoard" Margin="0,2,-9,2" Background="Transparent" CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}"
                                Width="40" MouseDown="Border_MouseDown" MouseUp="BorderStrokeSelectionCloneToNewBoard_MouseUp" Visibility="{Binding Visibility, ElementName=GridBackgroundCover}">
                            <ui:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="5">
                                <ui:SymbolIcon Symbol="Copy" Foreground="{DynamicResource FloatBarForeground}" />
                                <TextBlock Text="克隆至新页" FontSize="8" Foreground="{DynamicResource FloatBarForeground}" />
                            </ui:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}" />
                        <Border CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}" Height="40">
                            <ui:SimpleStackPanel VerticalAlignment="Center" Spacing="5" Margin="0,-10">
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="15">
                                    <Image Source="{DynamicResource Rotate45DrawingImage}" Height="22" MouseDown="Border_MouseDown" MouseUp="ImageRotate45_MouseUp" />
                                    <Image Source="{DynamicResource Rotate90DrawingImage}" Height="22" MouseDown="Border_MouseDown" MouseUp="ImageRotate90_MouseUp" />
                                </ui:SimpleStackPanel>
                                <TextBlock Text="旋转" FontSize="10" HorizontalAlignment="Center" Foreground="{DynamicResource FloatBarForeground}" />
                            </ui:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}" />
                        <Border Margin="0,0,-6,0" CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}" Height="40">
                            <ui:SimpleStackPanel VerticalAlignment="Center" Spacing="5" Margin="0,-10">
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="15">
                                    <Image Source="{DynamicResource FlipDrawingImage}" Width="19" Height="22" MouseDown="Border_MouseDown" MouseUp="ImageFlipHorizontal_MouseUp" />
                                    <Image Source="{DynamicResource FlipDrawingImage}" Width="19" Height="22" MouseDown="Border_MouseDown" MouseUp="ImageFlipVertical_MouseUp"
                                           Margin="0,0,8,0" RenderTransformOrigin="0.5,0.5">
                                        <Image.RenderTransform>
                                            <TransformGroup>
                                                <ScaleTransform />
                                                <SkewTransform />
                                                <RotateTransform Angle="90" />
                                                <TranslateTransform />
                                            </TransformGroup>
                                        </Image.RenderTransform>
                                    </Image>
                                </ui:SimpleStackPanel>
                                <TextBlock Text="翻转" FontSize="10" Margin="-8,0,0,0" HorizontalAlignment="Center" Foreground="{DynamicResource FloatBarForeground}" />
                            </ui:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}" />
                        <Border CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}" Height="40">
                            <ui:SimpleStackPanel VerticalAlignment="Center" Spacing="5" Margin="0,-10">
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="13">
                                    <Grid MouseDown="Border_MouseDown" MouseUp="GridPenWidthDecrease_MouseUp">
                                        <ui:SymbolIcon Symbol="Edit" Foreground="{DynamicResource FloatBarForeground}" />
                                        <TextBlock Text="-" Foreground="{DynamicResource FloatBarForeground}"
                                                   VerticalAlignment="Bottom" HorizontalAlignment="Right"
                                                   Margin="0,0,-2,-7" FontSize="15" />
                                    </Grid>
                                    <Grid MouseDown="Border_MouseDown" MouseUp="GridPenWidthIncrease_MouseUp">
                                        <ui:SymbolIcon Symbol="Edit" Foreground="{DynamicResource FloatBarForeground}" />
                                        <TextBlock Text="+" Foreground="{DynamicResource FloatBarForeground}"
                                                   VerticalAlignment="Bottom" HorizontalAlignment="Right"
                                                   Margin="0,0,-3,-4" FontSize="11" />
                                    </Grid>
                                    <Grid MouseDown="Border_MouseDown" MouseUp="GridPenWidthRestore_MouseUp">
                                        <ui:SymbolIcon Symbol="Edit" Foreground="{DynamicResource FloatBarForeground}" />
                                        <Image Source="{DynamicResource AndroidRefreshDrawingImage}" VerticalAlignment="Bottom" HorizontalAlignment="Right"
                                               Margin="0,0,-2,-2" Width="8">
                                        </Image>
                                    </Grid>
                                </ui:SimpleStackPanel>
                                <TextBlock Text="画笔粗细" FontSize="10" HorizontalAlignment="Center" Foreground="{DynamicResource FloatBarForeground}" />
                            </ui:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}" />
                        <Border Margin="-8,0,0,0" CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}" Width="40" MouseDown="Border_MouseDown" MouseUp="BorderStrokeSelectionDelete_MouseUp">
                            <ui:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="5">
                                <ui:SymbolIcon Symbol="Delete" Foreground="{DynamicResource FloatBarForeground}" />
                                <TextBlock Text="删除" FontSize="10" Foreground="{DynamicResource FloatBarForeground}" />
                            </ui:SimpleStackPanel>
                        </Border>
                    </ui:SimpleStackPanel>
                </Viewbox>
            </Border>
        </Grid>

        <Grid Visibility="Collapsed">
            <Grid Visibility="{Binding ElementName=GridBackgroundCoverHolder, Path=Visibility}">
                <Viewbox Margin="10" Height="50" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                        <Border Width="36" Height="36" CornerRadius="18" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6" MouseUp="GridPPTControlPrevious_MouseUp">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}" />
                            </Grid>
                        </Border>
                        <Border Visibility="{Binding ElementName=PptNavigationBtn, Path=Visibility}" Width="36" Height="36" CornerRadius="18" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid MouseUp="PPTNavigationBtn_Click">
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{Binding ElementName=PptNavigationTextBlock, Path=Foreground}" FontSize="{Binding ElementName=PptNavigationTextBlock, Path=FontSize}" Text="{Binding ElementName=PptNavigationTextBlock, Path=Text}" />
                            </Grid>
                        </Border>
                        <Border Width="36" Height="36" CornerRadius="18" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6" MouseUp="GridPPTControlNext_MouseUp">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}" />
                            </Grid>
                        </Border>
                    </ui:SimpleStackPanel>
                </Viewbox>
            </Grid>
        </Grid>
        <Grid Visibility="{Binding ElementName=GridBackgroundCoverHolder, Path=Visibility}">
            <Viewbox Visibility="{Binding ElementName=GridBackgroundCover, Path=Visibility}" Opacity="0.7" Margin="10" Height="50" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                    <Border Width="36" Height="36" MouseUp="BtnWhiteBoardAdd_Click" CornerRadius="18" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                        <Viewbox Margin="8">
                            <ui:SymbolIcon Symbol="Add" Foreground="{DynamicResource FloatBarForeground}" />
                        </Viewbox>
                    </Border>
                    <Border Width="36" MouseUp="BtnWhiteBoardSwitchPrevious_Click" Height="36" CornerRadius="18" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                        <Grid Margin="6">
                            <Image Visibility="Collapsed" Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideSelected}" />
                            <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}" />
                        </Grid>
                    </Border>
                    <Border Height="36" CornerRadius="2" Margin="0,0">
                        <TextBlock Text="{Binding ElementName=TextBlockWhiteBoardIndexInfo, Path=Text}"
                                   Foreground="White"
                                   VerticalAlignment="Center" HorizontalAlignment="Center"
                                   FontFamily="Microsoft YaHei UI" FontSize="12" />
                    </Border>
                    <Border Width="36" MouseUp="BtnWhiteBoardSwitchNext_Click" Height="36" CornerRadius="18" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                        <Grid Margin="6">
                            <Image Visibility="Collapsed" Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideSelected}" />
                            <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}" />
                        </Grid>
                    </Border>
                </ui:SimpleStackPanel>
            </Viewbox>
            <Viewbox Visibility="{Binding ElementName=GridBackgroundCover, Path=Visibility}" Opacity="0.7" Margin="10" Height="50" HorizontalAlignment="Left" VerticalAlignment="Bottom">
                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                    <Border Width="36" Height="36" MouseUp="BorderMultiTouchMode_MouseUp" CornerRadius="18" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                        <Viewbox Margin="8">
                            <ui:SymbolIcon Name="SymbolIconMultiTouchMode" Symbol="People" Foreground="{DynamicResource FloatBarForeground}" />
                        </Viewbox>
                    </Border>
                </ui:SimpleStackPanel>
            </Viewbox>
            <ui:SimpleStackPanel Spacing="10" Orientation="Horizontal"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Right"
                                 Height="50" Margin="10"
                                 Visibility="Collapsed">
                <Button Name="BtnWhiteBoardAdd" FontFamily="Microsoft YaHei UI"
                        Width="50" Height="48" FontSize="26" Click="BtnWhiteBoardAdd_Click"
                        Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}">
                    <ui:SymbolIcon Symbol="Add" />
                </Button>
                <Button Name="BtnWhiteBoardSwitchPrevious" FontFamily="Symbol"
                        Width="50" Height="48" FontSize="25" Click="BtnWhiteBoardSwitchPrevious_Click"
                        Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        VerticalContentAlignment="Center"
                        IsEnabled="False" IsEnabledChanged="Btn_IsEnabledChanged">
                    <Image RenderTransformOrigin="0.5,0.5" Opacity="0.25">
                        <Image.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform />
                                <SkewTransform />
                                <RotateTransform Angle="-90" />
                                <TranslateTransform />
                            </TransformGroup>
                        </Image.RenderTransform>
                        <Image.Source>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                        <DrawingGroup Opacity="1">
                                            <GeometryDrawing Brush="{Binding ElementName=BtnExit, Path=Foreground}" Geometry="F1 M64,64z M0,0z M32,26.41L16.566,41.844 14.439,39.717 32,22.156 49.561,39.717 47.434,41.844 32,26.41z" />
                                        </DrawingGroup>
                                    </DrawingGroup>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </Image.Source>
                    </Image>
                </Button>
                <Border Height="48" CornerRadius="2" Margin="3,0">
                    <TextBlock Name="TextBlockWhiteBoardIndexInfo"
                               Text="1 / 1"
                               Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                               VerticalAlignment="Center" HorizontalAlignment="Center" FontFamily="Microsoft YaHei UI" FontSize="18" />
                </Border>
                <Button Name="BtnWhiteBoardSwitchNext" FontFamily="Symbol"
                        Width="50" Height="48" FontSize="25" Click="BtnWhiteBoardSwitchNext_Click"
                        Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        VerticalContentAlignment="Center"
                        IsEnabled="False" IsEnabledChanged="Btn_IsEnabledChanged">
                    <Image RenderTransformOrigin="0.5,0.5" Opacity="0.25">
                        <Image.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform />
                                <SkewTransform />
                                <RotateTransform Angle="90" />
                                <TranslateTransform />
                            </TransformGroup>
                        </Image.RenderTransform>
                        <Image.Source>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                        <DrawingGroup Opacity="1">
                                            <GeometryDrawing Brush="{Binding ElementName=BtnExit, Path=Foreground}" Geometry="F1 M64,64z M0,0z M32,26.41L16.566,41.844 14.439,39.717 32,22.156 49.561,39.717 47.434,41.844 32,26.41z" />
                                        </DrawingGroup>
                                    </DrawingGroup>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </Image.Source>
                    </Image>
                </Button>
                <Button Name="BtnWhiteBoardDelete" Click="BtnWhiteBoardDelete_Click"
                        FontFamily="Microsoft YaHei UI" Width="50" Height="48" FontSize="26"
                        Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        IsEnabled="False">
                    <ui:SymbolIcon Symbol="Delete" />
                </Button>
            </ui:SimpleStackPanel>
        </Grid>

        <Border Name="BorderSettings" Background="White" BorderBrush="Black"
                BorderThickness="1" CornerRadius="10" ui:ThemeManager.RequestedTheme="Light"
                Width="400" HorizontalAlignment="Center"
                Margin="0,80,0,120" Visibility="Visible">
            <Grid>
                <ui:ScrollViewerEx Margin="0,60,0,50" VerticalScrollBarVisibility="Auto"
                                   PanningMode="VerticalOnly" ui:ThemeManager.RequestedTheme="Light"
                                   ManipulationBoundaryFeedback="SCManipulationBoundaryFeedback">
                    <StackPanel Margin="20,0,10,20">
                        <TextBlock FontSize="14" Margin="0,0,0,10"
                                   Text="* 设置将自动保存" />
                        <GroupBox>
                            <GroupBox.Header>
                                <Grid Height="36">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" VerticalAlignment="Center" Text="关于" FontSize="20"/>
                                    <ui:SimpleStackPanel Margin="0,0,4,0" Grid.Column="1" HorizontalAlignment="Right" Orientation="Horizontal" Spacing="8">
                                        <Button Click="HyperlinkSource_Click">
                                            <Canvas Width="24" Height="24" Background="Transparent">
                                                <Canvas.LayoutTransform>
                                                    <MatrixTransform Matrix="Identity" />
                                                </Canvas.LayoutTransform>
                                                <Path Data="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"
                                                      Stroke="{x:Null}"
                                                      Fill="#FF000000"
                                                      Stretch="Uniform"
                                                      Width="24"
                                                      Height="24"
                                                      SnapsToDevicePixels="False"
                                                      UseLayoutRounding="False"
                                                      StrokeThickness="0"
                                                      StrokeStartLineCap="flat"
                                                      StrokeEndLineCap="flat"
                                                      StrokeLineJoin="miter"/>
                                            </Canvas>
                                        </Button>
                                        <Button>
                                            <Canvas Width="24" Height="24" Background="Transparent">
                                                <Canvas.LayoutTransform>
                                                    <MatrixTransform Matrix="Identity" />
                                                </Canvas.LayoutTransform>
                                                <Path Data="M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741 0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792 0 0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704z"
                                                      Stroke="{x:Null}"
                                                      Fill="#FF000000"
                                                      Stretch="Uniform"
                                                      Width="24"
                                                      Height="24"
                                                      SnapsToDevicePixels="False"
                                                      UseLayoutRounding="False"
                                                      StrokeThickness="0"
                                                      StrokeStartLineCap="flat"
                                                      StrokeEndLineCap="flat"
                                                      StrokeLineJoin="miter"/>
                                            </Canvas>
                                            <ui:FlyoutService.Flyout>
                                                <ui:Flyout x:Name="FlyoutQQGroup" Placement="Bottom">
                                                    <StackPanel>
                                                        <TextBox
                                                            Margin="0,0,0,12"
                                                            Background="Transparent"
                                                            BorderThickness="0"
                                                            IsReadOnly="True"
                                                            TextWrapping="Wrap"
                                                            Text="群号: 996760298" />
                                                        <Button Content="跳转到 QQ" Click="HyperlinkQQGroup_Click" />
                                                    </StackPanel>
                                                </ui:Flyout>
                                            </ui:FlyoutService.Flyout>
                                        </Button>
                                        <Button>
                                            <Canvas MouseDown="HyperlinkWebsite_Click" Width="24" Height="24" Background="Transparent">
                                                <Canvas.LayoutTransform>
                                                    <MatrixTransform Matrix="Identity" />
                                                </Canvas.LayoutTransform>
                                                <Path Data="M16.36,14C16.44,13.34 16.5,12.68 16.5,12C16.5,11.32 16.44,10.66 16.36,10H19.74C19.9,10.64 20,11.31 20,12C20,12.69 19.9,13.36 19.74,14M14.59,19.56C15.19,18.45 15.65,17.25 15.97,16H18.92C17.96,17.65 16.43,18.93 14.59,19.56M14.34,14H9.66C9.56,13.34 9.5,12.68 9.5,12C9.5,11.32 9.56,10.65 9.66,10H14.34C14.43,10.65 14.5,11.32 14.5,12C14.5,12.68 14.43,13.34 14.34,14M12,19.96C11.17,18.76 10.5,17.43 10.09,16H13.91C13.5,17.43 12.83,18.76 12,19.96M8,8H5.08C6.03,6.34 7.57,5.06 9.4,4.44C8.8,5.55 8.35,6.75 8,8M5.08,16H8C8.35,17.25 8.8,18.45 9.4,19.56C7.57,18.93 6.03,17.65 5.08,16M4.26,14C4.1,13.36 4,12.69 4,12C4,11.31 4.1,10.64 4.26,10H7.64C7.56,10.66 7.5,11.32 7.5,12C7.5,12.68 7.56,13.34 7.64,14M12,4.03C12.83,5.23 13.5,6.57 13.91,8H10.09C10.5,6.57 11.17,5.23 12,4.03M18.92,8H15.97C15.65,6.75 15.19,5.55 14.59,4.44C16.43,5.07 17.96,6.34 18.92,8M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"
                                                      Stroke="{x:Null}"
                                                      Fill="#FF000000"
                                                      Stretch="Uniform"
                                                      Width="24"
                                                      Height="24"
                                                      SnapsToDevicePixels="False"
                                                      UseLayoutRounding="False"
                                                      StrokeThickness="0"
                                                      StrokeStartLineCap="flat"
                                                      StrokeEndLineCap="flat"
                                                      StrokeLineJoin="miter"/>
                                            </Canvas>
                                        </Button>
                                    </ui:SimpleStackPanel>
                                </Grid>
                            </GroupBox.Header>
                            <ui:SimpleStackPanel Spacing="12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                </Grid>
                                <StackPanel Orientation="Vertical" Margin="0,-12,0,0">
                                    <Image Grid.Column="0" Grid.Row="0" Width="64" Height="64" Stretch="Uniform">
                                        <Image.Source>
                                            <BitmapImage DecodePixelWidth="60" DecodePixelHeight="60" UriSource="pack://application:,,,/Resources/InkCanvas.png" />
                                        </Image.Source>
                                    </Image>
                                    <TextBlock HorizontalAlignment="Center" FontWeight="Bold" FontSize="20" Text="Ink Canvas Plus" />
                                    <TextBlock HorizontalAlignment="Center" FontSize="14" Text="Ink Canvas 的浴火重生版" />
                                    <TextBlock Grid.Column="1" Grid.Row="0" FontSize="14" TextWrapping="Wrap" TextAlignment="Center" Opacity="0.65" Margin="0,12,0,0">
                                        <Bold>Ink Canvas Plus</Bold> 是一款由 Clover Yan 维护、复刻自 WXRIW/Ink Canvas 的 Windows 画板应用，旨在优化和修复原项目各方面的使用体验，并尽可能地保留原版 Ink Canvas 的操作体验。
                                    </TextBlock>
                                </StackPanel>
                                <StackPanel Orientation="Vertical">
                                    <ui:SimpleStackPanel Name="AssemblyVersionInfoPanel" Orientation="Horizontal" HorizontalAlignment="Center" Spacing="4" Margin="0,0,0,6">
                                        <TextBlock FontSize="14">
                                            <Bold>当前版本:</Bold>
                                        </TextBlock>
                                        <TextBlock FontSize="14" Text="" Name="TextBlockVersion" />
                                    </ui:SimpleStackPanel>
                                    <StackPanel Name="CheckingUpdatesTip" Visibility="Collapsed" d:Visibility="Visible" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,6">
                                        <Canvas Width="16" Height="16">
                                            <Canvas.RenderTransform>
                                                <RotateTransform CenterX="8" CenterY="8" />
                                            </Canvas.RenderTransform>
                                            <Canvas.Triggers>
                                                <EventTrigger RoutedEvent="Loaded">
                                                    <BeginStoryboard>
                                                        <Storyboard>
                                                            <DoubleAnimation
                                                                Storyboard.TargetProperty="(Canvas.RenderTransform).(RotateTransform.Angle)" From="0"
                                                                To="-360" Duration="0:0:1" RepeatBehavior="Forever" />
                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </EventTrigger>
                                            </Canvas.Triggers>
                                            <Path Data="M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"
                                                  Stroke="{x:Null}"
                                                  Fill="#FF000000"
                                                  Stretch="Uniform"
                                                  Width="8"
                                                  Height="8"
                                                  SnapsToDevicePixels="False"
                                                  UseLayoutRounding="False"
                                                  StrokeThickness="0"
                                                  StrokeStartLineCap="flat"
                                                  StrokeEndLineCap="flat"
                                                  StrokeLineJoin="miter"/>
                                        </Canvas>
                                        <TextBlock Margin="8,0,0,0" FontSize="14" Text="少安毋躁，正在检查更新…" />
                                    </StackPanel>
                                    <Button Name="BtnCheckForUpdate" Content="检查更新" HorizontalAlignment="Center" Width="100" FontFamily="Microsoft YaHei UI" Click="BtnCheckForUpdate_Click" Margin="0,0,0,10" />
                                </StackPanel>
                                <ui:SimpleStackPanel Orientation="Horizontal" VerticalAlignment="Center" Spacing="4">
                                    <Canvas Width="20" Height="20">
                                        <Canvas.LayoutTransform>
                                            <MatrixTransform Matrix="1,0,0,-1,0,0" />
                                        </Canvas.LayoutTransform>
                                        <Path Data="M477.5 957.2916666666666C311.25 950.5 159.3333333333333 849.75 86.875 698.25C63.5 649.375 49.5416666666667 599.5416666666667 43.5833333333333 543.75C41.625 525.25 41.625 474.75 43.5833333333333 456.25C49.5416666666667 400.4583333333334 63.5 350.625 86.875 301.7500000000001C150.2083333333333 169.2916666666666 274.625 74.6250000000001 419.25 48.8333333333334C447.5 43.7916666666666 466.9583333333333 42.1666666666667 500 42.1666666666667C533.0416666666666 42.1666666666667 552.5 43.7916666666666 580.75 48.8333333333334C724.9583333333334 74.5833333333334 849.5 169.1250000000001 912.7916666666666 301C968.2916666666666 416.5833333333334 973.25 546.8333333333334 926.7083333333331 667.25C885.4999999999999 773.7916666666666 800.75 864.8333333333334 697.2916666666666 913.5833333333334C626.9166666666666 946.75 557.5 960.5416666666666 477.5 957.2916666666666M546.875 872C649.375 858.5833333333334 739 806.0833333333334 801.2916666666667 723C839.9166666666666 671.4583333333334 864.5 608.9583333333334 872.75 541.25C874.7916666666666 524.3333333333334 874.7916666666666 475.6666666666667 872.75 458.75C864.3333333333333 389.6250000000001 839.3333333333333 326.9166666666668 799.2499999999999 274.2083333333334C789.2083333333333 261.0416666666668 780.9166666666666 251.2500000000001 779.8333333333334 251.2500000000001C779.3749999999999 251.2500000000001 778.625 252.7916666666668 778.1666666666665 254.7083333333334C776.3333333333334 262.1250000000001 765.9166666666666 287.125 759.2083333333333 300.2083333333333C734.0833333333333 349.2916666666667 691.5 393.7083333333334 644.375 420C640.25 422.2916666666668 636.625 424.375 636.3333333333333 424.5833333333334C636.0416666666666 424.8333333333334 640.9583333333333 430.25 647.25 436.5833333333334C680 469.6250000000001 699.2916666666666 508.1250000000001 706.3333333333334 554.375C708.2916666666666 567.125 708.2916666666666 598.875 706.3749999999999 611.875C695.6666666666667 684.2916666666667 648.5 746.1666666666667 582.5 774.25C553.5416666666666 786.5833333333334 533.4166666666666 790.5833333333334 500 790.5833333333334C466.5833333333333 790.5833333333334 446.4583333333333 786.5833333333334 417.5 774.25C351.3333333333333 746.0833333333334 304.375 684.5416666666667 293.625 611.875C291.7083333333333 598.875 291.7083333333333 567.125 293.6666666666667 554.375C300.7083333333333 508.1250000000001 320 469.6250000000001 352.75 436.5833333333334C359.0416666666667 430.25 363.9583333333333 424.8333333333334 363.6666666666667 424.5833333333334C363.375 424.375 359.75 422.2916666666668 355.625 420C308.5 393.7083333333334 265.9166666666667 349.2916666666667 240.7916666666667 300.2083333333333C234.0833333333334 287.0833333333334 223.6666666666667 262.1250000000001 221.8333333333333 254.6250000000001C221.3333333333334 252.7083333333335 220.4583333333334 251.2916666666667 219.875 251.5000000000001C216.1666666666666 252.7916666666668 191.4166666666667 285.8750000000001 179.5833333333333 305.3333333333334C151.6666666666667 351.2916666666667 134.0833333333333 402.9166666666668 127.25 458.75C125.2083333333333 475.6666666666667 125.2083333333333 524.3333333333334 127.25 541.25C140.2083333333334 647.3333333333333 192.2083333333334 737.7083333333334 277 801.2916666666667C328.375 839.8333333333334 395.4583333333333 866.1666666666666 458.1249999999999 872.4166666666667C465.7083333333333 873.1666666666666 473.8333333333333 874 476.2499999999999 874.2916666666666C485.125 875.2916666666667 533.5416666666666 873.75 546.875 872M514.4166666666666 706.9583333333333C552.75 704.25 591.875 677.25 611.0416666666666 640.1666666666667C631.4166666666666 600.9166666666667 628.6666666666666 551.5416666666667 604.125 514.5833333333334C589.5 492.6250000000001 567.3333333333333 474.9166666666666 543.75 466.4166666666667C525.5416666666666 459.8750000000001 522.75 459.4166666666667 500 459.4166666666667C477.25 459.4166666666667 474.4583333333333 459.8750000000001 456.2499999999999 466.4166666666667C419.0833333333333 479.8333333333334 389.2083333333333 513.0833333333334 379.3333333333333 552C362.3333333333333 619 401.9166666666667 686.4583333333333 468.75 704.25C476.7083333333333 706.375 496.9583333333333 708.6666666666667 501.8749999999999 708C503.2499999999999 707.7916666666667 508.8749999999999 707.3333333333334 514.4166666666666 706.9583333333333M531.875 372.3333333333334C591.375 363.5 644.7916666666666 327.8333333333333 677.5 275.0833333333334C692.4166666666665 251.0833333333334 702.2083333333334 223.2083333333334 706.6666666666666 192.2083333333334C707.4583333333333 186.6666666666668 707.625 186.7916666666668 685.4166666666666 174.0833333333334C646.125 151.5833333333335 599.875 135.75 552.5 128.5416666666668C526.1666666666666 124.5416666666668 473.8333333333333 124.5416666666668 447.5 128.5416666666668C400.125 135.75 353.875 151.5833333333335 314.5833333333333 174.0833333333334C292.375 186.7916666666668 292.5416666666667 186.6666666666668 293.3333333333333 192.2083333333334C300.4583333333333 241.625 320.75 282.1666666666667 355.2083333333333 315.75C391.0416666666667 350.7083333333334 433.4166666666667 369.7916666666668 485 374.25C493.4583333333333 374.9583333333334 521.9583333333333 373.8333333333334 531.875 372.3333333333334"
                                          Stroke="{x:Null}"
                                          Fill="#FF000000"
                                          Stretch="Uniform"
                                          Width="20"
                                          Height="20"
                                          SnapsToDevicePixels="False"
                                          UseLayoutRounding="False"
                                          StrokeThickness="0"
                                          StrokeStartLineCap="flat"
                                          StrokeEndLineCap="flat"
                                          StrokeLineJoin="miter" />
                                    </Canvas>
                                    <TextBlock FontSize="15">
                                        <Bold>开发者:</Bold> Clover Yan, XY Wang (WXRIW)
                                    </TextBlock>
                                </ui:SimpleStackPanel>
                                <TextBlock FontSize="14" TextWrapping="Wrap">
                                    <Bold>贡献者:</Bold> Kengwang, Raspberry Kan, jiajiaxd, CN-Ironegg, Clover Yan, STBBRD, ChangSakura, Dubi906w
                                </TextBlock>
                                <TextBlock FontSize="14">
                                    <Bold>开源协议:</Bold> GNU General Public License v3.0
                                </TextBlock>
                                <!--<StackPanel>
                                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="12">
                                        <Button Content="检查更新" Width="100" FontFamily="Microsoft YaHei UI" Click="BtnCheckForUpdate_Click" Margin="0,0,0,10" />
                                        <ui:SymbolIcon Name="SymbolIconCheckForUpdateComplete" Symbol="Accept" Visibility="Collapsed" />
                                    </ui:SimpleStackPanel>
                                </StackPanel>-->
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="行为">
                            <ui:SimpleStackPanel Spacing="12">
                                <Grid HorizontalAlignment="Stretch">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Button Grid.Column="0" Content="重启应用" HorizontalAlignment="Stretch" FontFamily="Microsoft YaHei UI" Click="BtnRestart_Click" Margin="0,0,5,0" />
                                    <Button Grid.Column="1" Content="重置配置" Foreground="Red" HorizontalAlignment="Stretch" FontFamily="Microsoft YaHei UI" Margin="5,0,5,0">
                                        <ui:FlyoutService.Flyout>
                                            <ui:Flyout x:Name="FlyoutResetToDefault" Placement="Bottom">
                                                <StackPanel>
                                                    <TextBlock
                                                            Margin="0,0,0,12"
                                                            Text="确定要重置所有配置吗？此操作无法撤销。" />
                                                    <Button Content="重置所有配置" Foreground="White" Background="Red" FontFamily="Microsoft YaHei UI" Click="BtnResetToDefault_Click" />
                                                </StackPanel>
                                            </ui:Flyout>
                                        </ui:FlyoutService.Flyout>
                                    </Button>
                                    <Button Grid.Column="2" Content="退出应用" HorizontalAlignment="Stretch" FontFamily="Microsoft YaHei UI" Click="BtnExit_Click" Margin="5,0,0,0" />
                                </Grid>
                                <ui:ToggleSwitch Name="ToggleSwitchRunAtStartup" Header="开机时运行" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchRunAtStartup_Toggled" />
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="启动">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchAutoHideCanvas" Header="启动时不自动进入批注模式" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoHideCanvas_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchAutoEnterModeFinger" Header="自动进入手指模式" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoEnterModeFinger_Toggled" />
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="画板">
                            <ui:SimpleStackPanel Spacing="12">
                                <StackPanel Orientation="Horizontal">
                                    <Slider x:Name="InkWidthSlider"
                                            HorizontalAlignment="Left"
                                            Minimum="1" Maximum="20"
                                            Width="330" FontFamily="Microsoft YaHei UI"
                                            ui:ControlHelper.Header="画笔粗细"
                                            IsSnapToTickEnabled="True" Value="5"
                                            TickFrequency="1" TickPlacement="Both"
                                            ValueChanged="InkWidthSlider_ValueChanged" />
                                    <TextBlock Text="{Binding Value, ElementName=InkWidthSlider, Mode=OneWay}"
                                               VerticalAlignment="Bottom" Margin="10,0,0,8"
                                               FontSize="14" />
                                </StackPanel>
                                <ui:ToggleSwitch Name="ToggleSwitchShowCursor" Header="显示画笔光标" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowCursor_Toggled" />
                                <TextBlock Text="画笔样式" FontFamily="Microsoft YaHei UI" FontSize="14" />
                                <ComboBox Name="ComboBoxPenStyle" FontFamily="Microsoft YaHei UI" SelectedIndex="0" SelectionChanged="ComboBoxPenStyle_SelectionChanged">
                                    <ComboBoxItem Content="模拟笔锋（根据墨迹尾部计算）" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="模拟笔锋（根据速度计算）" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="无笔锋" FontFamily="Microsoft YaHei UI" />
                                </ComboBox>
                                <ui:ToggleSwitch Header="手指模式" IsOn="{Binding ElementName=ToggleSwitchModeFinger, Path=IsOn}" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" />
                                <TextBlock Text="此选项仅适用于可获取触摸面积的屏幕" TextWrapping="Wrap" Foreground="#666666" />
                                <TextBlock Text="橡皮模式" FontFamily="Microsoft YaHei UI" FontSize="14" />
                                <ComboBox Name="ComboBoxEraserType" FontFamily="Microsoft YaHei UI" SelectedIndex="0" SelectionChanged="ComboBoxEraserType_OnSelectionChanged">
                                    <ComboBoxItem Content="交替切换" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="面积擦" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="笔画擦" FontFamily="Microsoft YaHei UI" />
                                </ComboBox>
                                <TextBlock Text="橡皮大小" FontFamily="Microsoft YaHei UI" FontSize="14" />
                                <ComboBox Name="ComboBoxEraserSize" FontFamily="Microsoft YaHei UI" SelectedIndex="0" SelectionChanged="ComboBoxEraserSize_SelectionChanged">
                                    <ComboBoxItem Content="小（默认）" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="较小" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="中" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="较大" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="大" FontFamily="Microsoft YaHei UI" />
                                </ComboBox>
                                <ui:ToggleSwitch Name="ToggleSwitchHideStrokeWhenSelecting" Header="退出画板模式后隐藏墨迹" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchHideStrokeWhenSelecting_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchUsingWhiteboard" Header="使用白板 (白色背景)" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchUsingWhiteboard_Toggled" />
                                <TextBlock Text="保留双曲线渐近线" FontFamily="Microsoft YaHei UI" FontSize="14" />
                                <ComboBox Name="ComboBoxHyperbolaAsymptoteOption" FontFamily="Microsoft YaHei UI" SelectedIndex="2" SelectionChanged="ComboBoxHyperbolaAsymptoteOption_SelectionChanged">
                                    <ComboBoxItem Content="是" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="否" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="每次询问" FontFamily="Microsoft YaHei UI" />
                                </ComboBox>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="手势">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchDisableLockSmithByDefault" Header="默认启用双指手势" FontFamily="Microsoft YaHei UI" IsOn="True" OnContent="开" OffContent="关" Toggled="ToggleSwitchDisableLockSmithByDefault_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerZoom" Header="允许双指缩放" FontFamily="Microsoft YaHei UI" IsOn="True" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableTwoFingerZoom_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerTranslate" Header="允许双指移动" FontFamily="Microsoft YaHei UI" IsOn="True" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableTwoFingerTranslate_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerRotation" Header="允许双指旋转" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableTwoFingerRotation_Toggled" />
                                <TextBlock Text="允许选中墨迹后对墨迹进行双指或多指缩放操作（此设置不受“允许双指旋转”设置的影响）" TextWrapping="Wrap" Foreground="#666666" />
                                <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerRotationOnSelection" Header="允许双指旋转选中的墨迹" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableTwoFingerRotation_Toggled" />
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Name="GroupBoxInkRecognition" Header="墨迹识别 (Beta)">
                            <ui:SimpleStackPanel Spacing="12">
                                <TextBlock Text="墨迹识别功能目前处于开发阶段，目前可实现智能识别圆、三角形、&#x000A;矩形，并自动转换为规范图形。" Foreground="#666666" />
                                <ui:ToggleSwitch Name="ToggleSwitchEnableInkToShape" Header="启用墨迹识别" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableInkToShape_Toggled" IsOn="True" />
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Name="GroupBoxAppearance" Header="外观">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchTransparentButtonBackground" Header="按钮背景半透明" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchTransparentButtonBackground_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonExit" Header="显示“退出”按钮" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonExit_Toggled" />
                                <Button Content="立即退出" Width="120" Visibility="Collapsed" FontFamily="Microsoft YaHei UI" Click="BtnExit_Click" Margin="0,0,0,10" />
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonEraser" Header="显示“橡皮”按钮" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonEraser_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonHideControl" Header="显示“⇅ (显示或隐藏控制按钮)”按钮" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonHideControl_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonLRSwitch" Header="显示“⇆ (左右切换)”按钮" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonLRSwitch_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonModeFinger" Header="显示“手指模式”切换按钮" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonModeFinger_Toggled" />
                                <StackPanel Visibility="Collapsed" Orientation="Horizontal">
                                    <Slider x:Name="SideControlOpacitySlider"
                                            HorizontalAlignment="Left"
                                            Minimum="1" Maximum="100"
                                            Width="320" FontFamily="Microsoft YaHei UI"
                                            ui:ControlHelper.Header="控制栏透明度"
                                            IsSnapToTickEnabled="True" Value="100"
                                            TickFrequency="10" TickPlacement="Both"
                                            ValueChanged="SideControlOpacitySlider_ValueChanged" />
                                    <TextBlock Text="{Binding Value, ElementName=SideControlOpacitySlider, Mode=OneWay}"
                                               VerticalAlignment="Bottom" Margin="10,0,0,8"
                                               FontSize="14" Width="25" HorizontalAlignment="Center" />
                                </StackPanel>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Name="GroupBoxAppearanceNewUI" Header="外观">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchAutoCollapseFloatBar" Header="自动折叠浮动栏" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoCollapseFloatBar_Toggled" />
                                <ui:ToggleSwitch Header="显示“橡皮”按钮" IsOn="{Binding ElementName=ToggleSwitchShowButtonEraser, Path=IsOn}" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" />
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonPPTNavigation" Header="显示 PPT 浏览切页按钮" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonPPTNavigation_OnToggled" />
                                <TextBlock Text="颜色主题" FontFamily="Microsoft YaHei UI" FontSize="14" />
                                <ComboBox Name="ComboBoxTheme" FontFamily="Microsoft YaHei UI" SelectedIndex="0" SelectionChanged="ComboBoxTheme_SelectionChanged">
                                    <ComboBoxItem Content="浅色（经典）" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="深色" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="跟随系统" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="Plus 苜蓿绿 - 浅色" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="Plus 苜蓿绿 - 深色" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="Plus 苜蓿绿 - 跟随系统（默认）" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="Plus 三月粉 - 浅色" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="Plus 三月粉 - 深色" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="Plus 三月粉 - 跟随系统" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="Plus 朱砂红 - 浅色" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="Plus 朱砂红 - 深色" FontFamily="Microsoft YaHei UI" />
                                    <ComboBoxItem Content="Plus 朱砂红 - 跟随系统" FontFamily="Microsoft YaHei UI" />
                                </ComboBox>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="PowerPoint 相关">
                            <ui:SimpleStackPanel Spacing="12">
                                <TextBlock Text="此部分的设置项将会在幻灯片播放时使用，优先级高于其他设置项" Foreground="#666666" />
                                <ui:ToggleSwitch Name="ToggleSwitchSupportPowerPoint" Header="Microsoft PowerPoint 支持" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchSupportPowerPoint_Toggled" />
                                <TextBlock Text="我们并不推荐使用 WPS Office，因为其对于触摸设备的较差支持。" Foreground="#666666" />
                                <TextBlock Text="对 WPS Office 支持时会导致 WPS Office 关闭时卡顿，仅测试用。" Margin="0,-12,0,0" Foreground="#666666" />
                                <ui:ToggleSwitch Name="ToggleSwitchSupportWPS" Header="WPS Office 支持" IsOn="True" IsEnabled="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchSupportWPS_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchShowCanvasAtNewSlideShow" Header="开始放映时自动启动画板" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowCanvasAtNewSlideShow_Toggled" />
                                <TextBlock Text="默认在幻灯片模式下启用双指手势（关闭该选项之后，仍可以通过 LockSmith 钉子图标使用双指手势。）" TextWrapping="Wrap" Foreground="#666666" />
                                <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerGestureInPresentationMode" Header="默认在幻灯片模式下启用双指手势" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableTwoFingerGestureInPresentationMode_Toggled" />
                                <TextBlock Text="允许开启画板时使用手指手势进行幻灯片翻页（启用后，在幻灯片放映模式下，当画板无墨迹时，使用手指（笔尖或手掌无法识别）左右滑动即可控制幻灯片翻页。）" TextWrapping="Wrap" Foreground="#666666" />
                                <ui:ToggleSwitch Name="ToggleSwitchEnableFingerGestureSlideShowControl" Header="允许使用手指手势进行幻灯片翻页" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" IsOn="True" Toggled="ToggleSwitchEnableFingerGestureSlideShowControl_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchAutoSaveScreenShotInPowerPoint" Header="自动幻灯片截屏" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoSaveScreenShotInPowerPoint_Toggled" />
                                <TextBlock Text="开启后将在结束幻灯片放映时自动将已有墨迹保存至此电脑，并在下次打开时自动加载（文件名和幻灯片页数都要相同）" TextWrapping="Wrap" Foreground="#666666" />
                                <ui:ToggleSwitch Name="ToggleSwitchAutoSaveStrokesInPowerPoint" Header="自动保存幻灯片墨迹" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoSaveStrokesInPowerPoint_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchNotifyPreviousPage" Header="记忆并提示上次播放位置" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchNotifyPreviousPage_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchNotifyHiddenPage" Header="提示隐藏幻灯片" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchNotifyHiddenPage_Toggled" />

                                <ui:ToggleSwitch Name="ToggleSwitchNoStrokeClearInPowerPoint" Header="退出画板模式时不清除笔迹" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchNoStrokeClearInPowerPoint_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchShowStrokeOnSelectInPowerPoint" Header="退出画板模式时不隐藏笔迹" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowStrokeOnSelectInPowerPoint_Toggled" />
                            </ui:SimpleStackPanel>
                        </GroupBox>

                        <GroupBox Header="自动">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchAutoKillPptService" Header="自动查杀“PPT 小工具”" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoKillPptService_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchAutoKillEasiNote" Header="自动查杀“希沃白板 5”悬浮球" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoKillEasiNote_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchSaveScreenshotsInDateFolders" Header="截图分日期文件夹保存" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchSaveScreenshotsInDateFolders_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchAutoSaveStrokesAtScreenshot" Header="截图时自动保存墨迹" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoSaveStrokesAtScreenshot_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchAutoSaveStrokesAtClear" Header="清屏时自动截图" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoSaveStrokesAtClear_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchClearExitingWritingMode" Header="切换到鼠标模式后自动清屏" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchExitingWritingMode_Toggled" />
                                <StackPanel Orientation="Horizontal">
                                    <Slider x:Name="SideControlMinimumAutomationSlider"
                                            HorizontalAlignment="Left"
                                            Minimum="0" Maximum="10"
                                            Width="320" FontFamily="Microsoft YaHei UI"
                                            ui:ControlHelper.Header="自动截图最小墨迹量"
                                            IsSnapToTickEnabled="True" Value="0"
                                            TickFrequency="1" TickPlacement="Both"
                                            ValueChanged="SideControlMinimumAutomationSlider_ValueChanged" />
                                    <TextBlock Text="{Binding Value, ElementName=SideControlMinimumAutomationSlider, Mode=OneWay}"
                                               VerticalAlignment="Bottom" Margin="10,0,0,8"
                                               FontSize="14" Width="25" HorizontalAlignment="Center" />
                                </StackPanel>
                            </ui:SimpleStackPanel>
                        </GroupBox>

                        <GroupBox Header="高级">
                            <ui:SimpleStackPanel Spacing="12">
                                <TextBlock Text="可在手指触摸画板时显示圆形橡皮或手掌触摸画板时显示的橡皮比&#x000A;手掌大很多时调整" Foreground="#666666" />
                                <ui:ToggleSwitch Name="ToggleSwitchIsSpecialScreen" Header="特殊屏幕模式" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchIsSpecialScreen_OnToggled" />
                                <StackPanel Orientation="Horizontal" Visibility="{Binding Visibility,ElementName=TouchMultiplierSlider}">
                                    <Slider x:Name="TouchMultiplierSlider"
                                            HorizontalAlignment="Left"
                                            Minimum="0" Maximum="1"
                                            Width="300" FontFamily="Microsoft YaHei UI"
                                            ui:ControlHelper.Header="触摸大小倍数"
                                            IsSnapToTickEnabled="True"
                                            TickFrequency="0.05" TickPlacement="Both"
                                            ValueChanged="TouchMultiplierSlider_ValueChanged"
                                            Visibility="Collapsed" />
                                    <TextBlock Text="{Binding Value, ElementName=TouchMultiplierSlider, Mode=OneWay}"
                                               VerticalAlignment="Bottom" Margin="10,0,0,8"
                                               FontSize="14" Width="30" HorizontalAlignment="Center"
                                               Visibility="{Binding Path=Visibility, ElementName=TouchMultiplierSlider, Mode=OneWay}" />
                                </StackPanel>

                                <ui:SimpleStackPanel Spacing="8" Margin="0,4,0,4" Visibility="{Binding Visibility,ElementName=TouchMultiplierSlider}">
                                    <TextBlock FontSize="14" Text="在下方用笔尖点击以估计触摸大小倍数" />
                                    <TextBlock Text="数值仅供参考" Foreground="#666666" />
                                    <Border CornerRadius="4" Height="48" Background="#cccccc" TouchDown="BorderCalculateMultiplier_TouchDown" />
                                    <TextBlock Name="TextBlockShowCalculatedMultiplier" FontSize="14" />
                                </ui:SimpleStackPanel>

                                <ui:ToggleSwitch Name="ToggleSwitchEraserBindTouchMultiplier" Header="橡皮擦绑定触摸大小倍数" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" IsOn="False" Toggled="ToggleSwitchEraserBindTouchMultiplier_Toggled" Visibility="{Binding Path=Visibility, ElementName=TouchMultiplierSlider, Mode=OneWay}" />
                                <ui:ToggleSwitch Name="ToggleSwitchIsQuadIR" Header="四边红外模式" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchIsQuadIR_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchIsLogEnabled" Header="记录日志" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" IsOn="True" Toggled="ToggleSwitchIsLogEnabled_Toggled" />
                                <ui:ToggleSwitch Name="ToggleSwitchDisableEdgeGesture" Header="画板模式下禁用触摸屏边缘手势" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" IsOn="True" Toggled="ToggleSwitchDisableEdgeGesture_Toggled" />
                                <TextBlock TextWrapping="Wrap" Text="开启后可阻止 Windows 10 以上设备在屏幕边缘书写时滑出任务视图、通知中心或操作中心，并缓解书写卡顿的问题（Windows 11 多指多任务手势可以在系统设置中关闭）" Foreground="#666666" />
                            </ui:SimpleStackPanel>
                        </GroupBox>
                    </StackPanel>
                </ui:ScrollViewerEx>
                <Grid Background="White" Margin="10,0,10,0" Height="60" VerticalAlignment="Top">
                    <Grid Margin="10,20,10,-10">
                        <TextBlock Text="Ink Canvas Plus 设置" FontSize="26" Margin="0,0,0,12" />
                        <!--<Viewbox Margin="0,-55,0,0" Height="60" HorizontalAlignment="Right">
                        <StackPanel Orientation="Horizontal">
                            <Image Source="logo.png" Width="120" />
                            <Image Source="text.png" Width="200" />
                        </StackPanel>
                    </Viewbox>-->
                    </Grid>
                </Grid>
                <Grid VerticalAlignment="Bottom" Height="50">
                    <Button FontFamily="Microsoft YaHei UI"
                            Width="120" Margin="10"
                            HorizontalAlignment="Right"
                            Content="关闭"
                            Click="BtnSettings_Click" />
                </Grid>
            </Grid>
        </Border>

        <Grid Name="GridNotifications" Margin="0,110" Visibility="Collapsed" HorizontalAlignment="Center" VerticalAlignment="Bottom">
            <Border CornerRadius="25" Height="50" Background="LightGray" Opacity="0.85">
                <TextBlock Name="TextBlockNotice" Text="测试文本" Margin="20,0" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="16" />
            </Border>
        </Grid>

        <Viewbox Name="ViewBoxStackPanelMain" Visibility="Visible" Margin="10,10,10,55" HorizontalAlignment="Right" VerticalAlignment="Bottom" Width="46">
            <StackPanel Name="StackPanelMain" Width="46">
                <StackPanel Name="StackPanelControl">
                    <Button Name="BtnExit" Content="退出" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnExit_Click" Background="#7F909090" />
                    <Button Name="BtnSettings" Content="设置" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnSettings_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                    <TextBlock Text="自动&#x000A;粗细" Visibility="Collapsed" Margin="0,10,0,0"
                               FontSize="14" HorizontalAlignment="Center"
                               Foreground="{Binding ElementName=BtnExit, Path=Foreground}" />
                    <!--<Viewbox Height="30" Visibility="Collapsed">
                        <ui:ToggleSwitch Name="ToggleSwitchAutoWeight" Header="" Width="40.5"
                                     FontFamily="Microsoft YaHei UI" FontSize="19"
                                     OnContent="" OffContent="" Toggled="ToggleSwitchAutoWeight_Toggled" />
                    </Viewbox>-->
                    <StackPanel Name="StackPanelModeFinger" Background="#01000000">
                        <TextBlock Text="手指&#x000A;模式" Margin="0,10,0,0"
                                   FontSize="14" HorizontalAlignment="Center"
                                   Foreground="{Binding ElementName=BtnExit, Path=Foreground}" />
                        <Viewbox Height="30">
                            <ui:ToggleSwitch Name="ToggleSwitchModeFinger" Header="" Width="40.5"
                                             FontFamily="Microsoft YaHei UI" FontSize="19"
                                             OnContent="" OffContent="" Toggled="ToggleSwitchModeFinger_Toggled" />
                        </Viewbox>
                    </StackPanel>
                    <Button Name="BtnThickness" Content="粗细" Visibility="Collapsed" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnThickness_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                    <Button Name="BtnSwitchTheme" Content="深色" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnSwitchTheme_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                    <Button Name="BtnSwitch" Content="背景" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnSwitch_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                    <StackPanel Name="StackPanelColors" Margin="7,0,7,0">
                        <Button Name="BtnColorBlack" FontFamily="Microsoft YaHei UI" Background="Black"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorBlack_Click">
                            <Viewbox Name="ViewboxBtnColorBlackContent" Opacity="0">
                                <ui:SymbolIcon Symbol="Accept" Name="SymbolIconBtnColorBlackContent" Foreground="White" />
                            </Viewbox>
                        </Button>
                        <Button Name="BtnColorRed" FontFamily="Microsoft YaHei UI" Background="Red"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorRed_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}">
                            <Viewbox Name="ViewboxBtnColorRedContent">
                                <ui:SymbolIcon Symbol="Accept" Foreground="{Binding ElementName=SymbolIconBtnColorBlackContent, Path=Foreground}" />
                            </Viewbox>
                        </Button>
                        <Button Name="BtnColorGreen" FontFamily="Microsoft YaHei UI" Background="#169141"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorGreen_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}">
                            <Viewbox Name="ViewboxBtnColorGreenContent" Opacity="0">
                                <ui:SymbolIcon Symbol="Accept" Foreground="{Binding ElementName=SymbolIconBtnColorBlackContent, Path=Foreground}" />
                            </Viewbox>
                        </Button>
                        <Button Name="BtnColorBlue" FontFamily="Microsoft YaHei UI" Background="#239AD6"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorBlue_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}">
                            <Viewbox Name="ViewboxBtnColorBlueContent" Opacity="0">
                                <ui:SymbolIcon Symbol="Accept" Foreground="{Binding ElementName=SymbolIconBtnColorBlackContent, Path=Foreground}" />
                            </Viewbox>
                        </Button>
                        <Button Name="BtnColorYellow" FontFamily="Microsoft YaHei UI" Background="#F38B00"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorYellow_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}">
                            <Viewbox Name="ViewboxBtnColorYellowContent" Opacity="0">
                                <ui:SymbolIcon Symbol="Accept" Foreground="{Binding ElementName=SymbolIconBtnColorBlackContent, Path=Foreground}" />
                            </Viewbox>
                        </Button>
                        <Button Name="BtnColorPurple" FontFamily="Microsoft YaHei UI" Background="Purple"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Height="{Binding ElementName=StackPanelColors, Path=ActualWidth}"
                                Click="BtnColorPurple_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}">
                            <Viewbox Name="ViewboxBtnColorPurpleContent" Opacity="0">
                                <ui:SymbolIcon Symbol="Accept" Foreground="{Binding ElementName=SymbolIconBtnColorBlackContent, Path=Foreground}" />
                            </Viewbox>
                        </Button>
                    </StackPanel>
                    <Button Name="BtnClear" Content="清屏" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnClear_Click" MouseDoubleClick="BtnClear_MouseDoubleClick" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                    <Button x:Name="BtnHideInkCanvas" Content="隐藏&#x000A;画板" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnHideInkCanvas_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                    <Button x:Name="BtnTools" Content="工具" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnTools_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                    <Grid Name="StackPanelToolButtons" Margin="-127,-30.5,56,0">
                        <Border CornerRadius="18" Margin="-7"
                                Background="White" Visibility="Collapsed"
                                BorderBrush="#0066BF" BorderThickness="1" />
                        <ui:SimpleStackPanel Orientation="Horizontal" Spacing="10">
                            <Button x:Name="BtnCountdownTimer" Content="计时器" FontFamily="Microsoft YaHei UI"
                                    Margin="0,0,0,0"
                                    Click="BtnCountdownTimer_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                            <Button x:Name="BtnRand" Content="抽奖" FontFamily="Microsoft YaHei UI"
                                    Margin="0,0,0,0"
                                    Click="BtnRand_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                        </ui:SimpleStackPanel>
                    </Grid>
                    <Button x:Name="BtnScreenshot" Content="截屏" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnScreenshot_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                    <Button x:Name="BtnCheckPPT" Visibility="Collapsed" Content="检查" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnCheckPPT_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                    <StackPanel Name="StackPanelPPTButtons">
                        <Button x:Name="BtnPPTSlideShow" Visibility="Collapsed" Content="从头&#x000A;放映" FontFamily="Microsoft YaHei UI"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                Click="BtnPPTSlideShow_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                        <Button x:Name="BtnPPTSlideShowEnd" Visibility="Collapsed" Content="结束&#x000A;放映" FontFamily="Microsoft YaHei UI"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                Click="BtnPPTSlideShowEnd_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                        <StackPanel Name="StackPanelPPTControls" Visibility="Collapsed">
                            <Button x:Name="BtnPPTSlidesUp" Content="↑" FontFamily="Microsoft YaHei UI"
                                    Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                    Click="BtnPPTSlidesUp_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                            <Button x:Name="BtnPPTSlidesDown" Content="↓" FontFamily="Microsoft YaHei UI"
                                    Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                    Click="BtnPPTSlidesDown_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                        </StackPanel>
                    </StackPanel>
                    <Button x:Name="BtnSwitchSide" Content="⇆" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnSwitchSide_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                </StackPanel>
                <Button x:Name="BtnHideControl" Content="⇅" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnHideControl_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                <StackPanel>
                    <TextBlock Visibility="{Binding ElementName=GroupBoxMASEZVersion, Path=Visibility}" Text="二中专版" FontSize="11" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,10,0,0" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" />
                    <Image Visibility="{Binding ElementName=GroupBoxMASEZVersion, Path=Visibility}" Source="Resources/logo2.png" Margin="0,-5,0,-15" />
                    <StackPanel x:Name="StackPanelInfo">
                        <TextBlock Text="Developer" FontSize="8.5" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,10,0,0" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" />
                        <TextBlock Text="XY Wang" FontSize="9" HorizontalAlignment="Center" Margin="0,3,0,0" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" />
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </Viewbox>
        <Viewbox Name="ViewBoxStackPanelShapes" Margin="{Binding ElementName=ViewBoxStackPanelMain, Path=Margin}" Width="46" HorizontalAlignment="Left" VerticalAlignment="Bottom" Visibility="Visible">
            <StackPanel Name="StackPanelShapes" Width="46">
                <Slider HorizontalAlignment="Center" Visibility="Collapsed"
                        Minimum="1" Maximum="20" Orientation="Vertical"
                        Height="330" FontFamily="Microsoft YaHei UI"
                        ui:ControlHelper.Header="画笔&#x000A;粗细"
                        IsSnapToTickEnabled="True"
                        TickFrequency="1" TickPlacement="Both"
                        RenderTransformOrigin="0.5,0.5"
                        Value="{Binding ElementName=InkWidthSlider, Path=Value, Mode=TwoWay}">
                </Slider>
                <TextBlock Text="画笔&#x000A;粗细" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                           FontSize="14" Margin="0,10,0,0" HorizontalAlignment="Center" />
                <Button Name="BtnPenWidthIncrease" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,5" Height="{Binding ElementName=BtnPen, Path=ActualHeight}" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnPenWidthIncrease_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}">
                    <!--<ui:SymbolIcon Symbol="Add" />-->
                    <Grid Margin="0,2,-5,0">
                        <TextBlock Text="&lt;" FontFamily="Symbol" FontSize="22" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock.LayoutTransform>
                                <RotateTransform Angle="90" />
                            </TextBlock.LayoutTransform>
                        </TextBlock>
                    </Grid>
                </Button>
                <TextBlock Visibility="Visible" Text="{Binding Value, ElementName=InkWidthSlider, Mode=OneWay}"
                           FontSize="14" HorizontalAlignment="Center" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" />
                <Button Name="BtnPenWidthDecrease" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,5,0,0" Height="{Binding ElementName=BtnPen, Path=ActualHeight}" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnPenWidthDecrease_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}">
                    <!--<ui:SymbolIcon Symbol="Remove" />-->
                    <Grid Margin="0,4,-5,0">
                        <TextBlock Text="&gt;" FontFamily="Symbol" FontSize="22" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock.LayoutTransform>
                                <RotateTransform Angle="90" />
                            </TextBlock.LayoutTransform>
                        </TextBlock>
                    </Grid>
                </Button>
                <Button Name="BtnFingerDragMode" Content="单指&#x000A;拖动" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,25,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnFingerDragMode_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                <Button Name="BtnSelect" Content="选择&#x000A;墨迹" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnSelect_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                <Button Name="BtnPen" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnPen_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}">
                    <ui:SymbolIcon Symbol="Edit" />
                </Button>
                <Button Name="BtnErase" Content="橡皮" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnErase_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                <Button Name="BtnDrawLine" Content="直线" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,25,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnDrawLine_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                <Button Name="BtnDrawArrow" Content="箭头" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnDrawArrow_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                <Button Name="BtnDrawRectangle" Content="矩形" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnDrawRectangle_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                <Button Name="BtnDrawEllipse" Content="椭圆" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,15" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnDrawEllipse_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                <StackPanel IsVisibleChanged="StackPanel_IsVisibleChanged" Visibility="{Binding ElementName=StackPanelPPTButtons, Path=Visibility}">
                    <StackPanel Visibility="{Binding ElementName=StackPanelPPTControls, Path=Visibility}">
                        <Button Content="↑" FontFamily="Microsoft YaHei UI"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                Click="BtnPPTSlidesUp_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                        <Button Content="↓" FontFamily="Microsoft YaHei UI"
                                Margin="0,10,0,15" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                Click="BtnPPTSlidesDown_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                    </StackPanel>
                </StackPanel>
                <Button Content="清屏" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnClear_Click" MouseDoubleClick="BtnClear_MouseDoubleClick" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                <Button x:Name="BtnUndo" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnUndo_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        IsEnabled="False" Visibility="Collapsed" IsEnabledChanged="Btn_IsEnabledChanged">
                    <StackPanel Opacity="0.2">
                        <ui:SymbolIcon Symbol="Undo" />
                        <TextBlock Text="撤销" Margin="0,4,0,0" />
                    </StackPanel>
                </Button>
                <Button x:Name="BtnRedo" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnRedo_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        IsEnabled="False" Visibility="Collapsed" IsEnabledChanged="Btn_IsEnabledChanged">
                    <StackPanel Opacity="0.2">
                        <ui:SymbolIcon Symbol="Redo" />
                        <TextBlock Text="恢复" Margin="0,4,0,0" />
                    </StackPanel>
                </Button>
                <Button Name="BtnClearAndHideCanvas" Content="清屏&#x000A;&amp;&#x000A;隐藏" Visibility="Collapsed" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}" Block.TextAlignment="Center"
                        Click="BtnSelect_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}" />
                <Grid Name="GridForLeftSideReservedSpace" Height="{Binding ElementName=StackPanelInfo, Path=ActualHeight}" />
            </StackPanel>
        </Viewbox>

        <Grid Name="GridForRecoverOldUI">
            <Grid Visibility="{Binding ElementName=StackPanelPPTControls, Path=Visibility}">
                <Viewbox Name="ViewboxPPTSidesControl" Visibility="{Binding ElementName=StackPanelPPTButtons, Path=Visibility}" Opacity="0.7" Margin="10" Height="50" HorizontalAlignment="Left" VerticalAlignment="Bottom">
                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                        <Border Width="36" MouseUp="GridPPTControlPrevious_MouseUp" Height="36" CornerRadius="18" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6">
                                <Image Name="ImagePPTControlPreviousPressed" Visibility="Collapsed" Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideSelected}" />
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}" />
                            </Grid>
                        </Border>
                        <Border x:Name="PptNavigationBtn" Width="Auto" MinWidth="36" Height="36" CornerRadius="18" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid MouseUp="PPTNavigationBtn_Click">
                                <TextBlock Name="PptNavigationTextBlock" FontSize="10" Foreground="{DynamicResource FloatBarForeground}" HorizontalAlignment="Center" VerticalAlignment="Center" Text="0/0" Margin="2" />
                            </Grid>
                        </Border>
                        <Border Width="36" MouseUp="GridPPTControlNext_MouseUp" Height="36" CornerRadius="18" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6">
                                <Image Name="ImagePPTControlNextPressed" Visibility="Collapsed" Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideSelected}" />
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}" />
                            </Grid>
                        </Border>
                    </ui:SimpleStackPanel>
                </Viewbox>
                <Viewbox Visibility="{Binding ElementName=StackPanelPPTButtons, Path=Visibility}" Opacity="{Binding ElementName=ViewboxPPTSidesControl, Path=Opacity}" Margin="10" Height="50" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                        <Border Width="36" MouseUp="GridPPTControlPrevious_MouseUp" Height="36" CornerRadius="18" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}" />
                            </Grid>
                        </Border>
                        <Border Width="Auto" MinWidth="36" Visibility="{Binding ElementName=PptNavigationBtn, Path=Visibility}" Height="36" CornerRadius="18" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid MouseUp="PPTNavigationBtn_Click">
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{Binding ElementName=PptNavigationTextBlock, Path=Foreground}" FontSize="{Binding ElementName=PptNavigationTextBlock, Path=FontSize}" Text="{Binding ElementName=PptNavigationTextBlock, Path=Text}" Margin="2" />
                            </Grid>
                        </Border>
                        <Border Width="36" MouseUp="GridPPTControlNext_MouseUp" Height="36" CornerRadius="18" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}" />
                            </Grid>
                        </Border>
                    </ui:SimpleStackPanel>
                </Viewbox>
            </Grid>
        </Grid>

        <Viewbox Name="ViewboxFloatingBar" Margin="100,10,-2000,-200"
                 HorizontalAlignment="Left" Height="50" VerticalAlignment="Top">
            <Viewbox.LayoutTransform>
                <ScaleTransform x:Name="ViewboxFloatingBarScaleTransform" ScaleX="1" ScaleY="1" />
            </Viewbox.LayoutTransform>
            <ui:SimpleStackPanel Orientation="Horizontal">
                <Border Width="36" Height="36" CornerRadius="18" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}" MouseDown="SymbolIconEmoji_MouseDown" MouseUp="SymbolIconEmoji_MouseUp">
                    <ui:SimpleStackPanel Margin="0,5,0,5" Spacing="10" Orientation="Horizontal"
                                         HorizontalAlignment="Center">
                        <ui:SymbolIcon Name="SymbolIconEmoji" Symbol="Emoji2" Foreground="{DynamicResource FloatBarForeground}" />
                    </ui:SimpleStackPanel>
                </Border>
                <Border Margin="5,0,0,0" Visibility="Visible" Height="36" Name="BorderFloatingBarMainControls" Background="{DynamicResource FloatBarBackground}" CornerRadius="18" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                    <Border.RenderTransform>
                        <ScaleTransform />
                    </Border.RenderTransform>
                    <ui:SimpleStackPanel Name="StackPanelFloatingBar" Spacing="10" Orientation="Horizontal">
                        <ui:SimpleStackPanel Name="StackPanelCanvacMain" Margin="10,5,0,5" Spacing="10" Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                            <Grid Height="24" Width="0">
                            </Grid>
                            <controls:ClickSensitiveGrid Click="SymbolIconCursor_Click" Margin="-10,0,0,0">
                                <ui:SymbolIcon Symbol="Edit" Foreground="{DynamicResource FloatBarForeground}" />
                            </controls:ClickSensitiveGrid>
                            <ui:SymbolIcon Symbol="Setting" Foreground="{DynamicResource FloatBarForeground}" MouseUp="SymbolIconSettings_Click" />
                        </ui:SimpleStackPanel>
                        <ui:SimpleStackPanel Name="StackPanelCanvasControls" Visibility="Visible" Margin="10,5,0,5" Spacing="10" Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                            <controls:ClickSensitiveGrid Click="SymbolIconCursor_Click">
                                <ui:SymbolIcon Symbol="TouchPointer" Foreground="{DynamicResource FloatBarForeground}" />
                            </controls:ClickSensitiveGrid>
                            <ui:SimpleStackPanel Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}" Spacing="8" Margin="0,1">
                                <Border Name="BorderPenColorBlack" Background="{Binding ElementName=BtnColorBlack, Path=Background}" MouseUp="BorderPenColorBlack_MouseUp" CornerRadius="100"
                                        Width="{Binding ElementName=BorderPenColorBlack, Path=ActualHeight}">
                                    <Viewbox Opacity="{Binding ElementName=ViewboxBtnColorBlackContent, Path=Opacity}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White" />
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorRed" Background="{Binding ElementName=BtnColorRed, Path=Background}" MouseUp="BorderPenColorRed_MouseUp" CornerRadius="100"
                                        Width="{Binding ElementName=BorderPenColorRed, Path=ActualHeight}">
                                    <Viewbox Opacity="{Binding ElementName=ViewboxBtnColorRedContent, Path=Opacity}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White" />
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorGreen" Background="{Binding ElementName=BtnColorGreen, Path=Background}" MouseUp="BorderPenColorGreen_MouseUp" CornerRadius="100"
                                        Width="{Binding ElementName=BorderPenColorGreen, Path=ActualHeight}">
                                    <Viewbox Opacity="{Binding ElementName=ViewboxBtnColorGreenContent, Path=Opacity}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White" />
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorBlue" Background="{Binding ElementName=BtnColorBlue, Path=Background}" MouseUp="BorderPenColorBlue_MouseUp" CornerRadius="100"
                                        Width="{Binding ElementName=BorderPenColorBlue, Path=ActualHeight}">
                                    <Viewbox Opacity="{Binding ElementName=ViewboxBtnColorBlueContent, Path=Opacity}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White" />
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorYellow" Background="{Binding ElementName=BtnColorYellow, Path=Background}" MouseUp="BorderPenColorYellow_MouseUp" CornerRadius="100"
                                        Width="{Binding ElementName=BorderPenColorYellow, Path=ActualHeight}">
                                    <Viewbox Opacity="{Binding ElementName=ViewboxBtnColorYellowContent, Path=Opacity}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White" />
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorPurple" Background="{Binding ElementName=BtnColorPurple, Path=Background}" MouseUp="BorderPenColorPurple_MouseUp" CornerRadius="100"
                                        Width="{Binding ElementName=BorderPenColorYellow, Path=ActualHeight}">
                                    <Viewbox Opacity="{Binding ElementName=ViewboxBtnColorPurpleContent, Path=Opacity}" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="White" />
                                    </Viewbox>
                                </Border>
                                <Border Name="BorderPenColorWhite" Background="White" CornerRadius="100" MouseUp="BorderPenColorWhite_MouseUp"
                                        Width="{Binding ElementName=BorderPenColorYellow, Path=ActualHeight}">
                                    <Viewbox Name="ViewboxBtnColorWhiteContent" Opacity="0" Margin="6">
                                        <ui:SymbolIcon Symbol="Accept" Foreground="Black" />
                                    </Viewbox>
                                </Border>
                            </ui:SimpleStackPanel>
                            <Grid x:Name="EraserContainer" Width="21" Height="24" Margin="0,1.5,-2,0" MouseDown="Border_MouseDown" MouseUp="ImageEraser_MouseUp" Visibility="{Binding ElementName=BtnErase, Path=Visibility}">
                                <Image Name="ImageEraser" Margin="0,-4,-1,-2" Source="{DynamicResource ImageSource.RubberNormal}" RenderTransformOrigin="0.5,0.5" />
                                <Image Name="ImageEraserMask" Visibility="{Binding Visibility, ElementName=ImageEraser, Converter={StaticResource VisibilityConverter}}" Margin="0,-2.5,0,0" RenderTransformOrigin="0.5,0.5">
                                    <Image.Source>
                                        <DrawingImage>
                                            <DrawingImage.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing>
                                                            <GeometryDrawing.Brush>
                                                                <SolidColorBrush
                                                                    Color="#FFD8D8D8"
                                                                    Opacity="0" />
                                                            </GeometryDrawing.Brush>
                                                            <GeometryDrawing.Pen>
                                                                <Pen
                                                                    Thickness="1"
                                                                    StartLineCap="Flat"
                                                                    EndLineCap="Flat"
                                                                    LineJoin="Miter">
                                                                    <Pen.Brush>
                                                                        <SolidColorBrush
                                                                            Color="#FF979797"
                                                                            Opacity="0" />
                                                                    </Pen.Brush>
                                                                </Pen>
                                                            </GeometryDrawing.Pen>
                                                            <GeometryDrawing.Geometry>
                                                                <PathGeometry
                                                                    FillRule="EvenOdd"
                                                                    Figures="M31,31L32,31 32,32 31,32 31,31z M0,0L1,0 1,1 0,1 0,0z" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <DrawingGroup
                                                            Transform="-0.707106781186548,-0.707106781186547,-0.707106781186547,0.707106781186548,31.4055917955108,13.0208154846605">
                                                            <DrawingGroup.Children>
                                                                <GeometryDrawing x:Name="GeometryDrawingEraser"
                                                                                 Brush="#FF666666">
                                                                    <GeometryDrawing.Geometry>
                                                                        <PathGeometry
                                                                            FillRule="EvenOdd"
                                                                            Figures="M16.7928932,16.2426407L16.7928932,0.788350252C16.7928932,0.248156103,16.3447877,-0.207106781,15.7920216,-0.207106781L1.79376488,-0.207106781C1.23752408,-0.207106781,0.792893219,0.238574513,0.792893219,0.788350252L0.792893219,16.2426407 16.7928932,16.2426407z M16.7928932,18.2426407L16.7928932,23.7974362C16.7928932,24.3472119,16.3482624,24.7928932,15.7920216,24.7928932L1.79376488,24.7928932C1.24099872,24.7928932,0.792893219,24.3376303,0.792893219,23.7974362L0.792893219,18.2426407 16.7928932,18.2426407z" />
                                                                    </GeometryDrawing.Geometry>
                                                                </GeometryDrawing>
                                                            </DrawingGroup.Children>
                                                        </DrawingGroup>
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingImage.Drawing>
                                        </DrawingImage>
                                    </Image.Source>
                                </Image>
                            </Grid>
                            <Grid Margin="0,0,0,0" Width="20">
                                <ui:SymbolIcon Name="SymbolIconDelete" Symbol="Delete" Foreground="{DynamicResource FloatBarForeground}"
                                               MouseDown="Border_MouseDown" MouseUp="SymbolIconDelete_MouseUp" />
                                <Border x:Name="BorderClearInDelete" Visibility="Collapsed" Background="White" BorderBrush="{DynamicResource FloatBarBorderBrush}" BorderThickness="1"
                                        CornerRadius="18" Margin="-40,-60,-40,35">
                                    <Button Content="点击清屏" ui:ThemeManager.RequestedTheme="Light"
                                            FontFamily="Microsoft YaHei UI"
                                            Width="80" HorizontalAlignment="Center"
                                            Click="BtnClear_Click" />
                                </Border>
                            </Grid>
                            <ui:SymbolIcon Name="SymbolIconSelect" Symbol="SelectAll" Foreground="{DynamicResource FloatBarForeground}" MouseUp="SymbolIconSelect_MouseUp" />
                            <Grid Margin="3,5,0,5">
                                <Image MouseUp="ImageDrawShape_MouseUp" MouseDown="Border_MouseDown" Margin="-2.5" Source="{DynamicResource DrawShapeImageSource.DrawShapeIcon}" />
                                <Border x:Name="BorderDrawShape" Visibility="Visible" Background="{DynamicResource FloatBarBackground}" BorderBrush="{DynamicResource FloatBarBorderBrush}" BorderThickness="1"
                                        CornerRadius="18" Margin="-100,-265,-100,30" Height="240">
                                    <Viewbox Margin="0,0,0,2">
                                        <ui:SimpleStackPanel Spacing="-8" Orientation="Vertical">
                                            <TextBlock FontSize="16" Foreground="{DynamicResource FloatBarForeground}"
                                                       HorizontalAlignment="Left" Margin="10,8">
                                                <Run Text="图形" />
                                                <Run Text="(第一行支持长按保持选中)" FontSize="10" />
                                            </TextBlock>
                                            <ui:SymbolIcon Margin="0,-20,8,15" Symbol="Pin" MouseDown="Border_MouseDown" MouseUp="SymbolIconPinBorderDrawShape_MouseUp" Foreground="{DynamicResource FloatBarForeground}" HorizontalAlignment="Right" />
                                            <ui:SimpleStackPanel Margin="20,0,0,0" Orientation="Horizontal">
                                                <ui:SimpleStackPanel Visibility="Collapsed" Margin="58,6,5,6" Width="54">
                                                    <Label Margin="0,0,0,-2" Content="自动隐藏" Foreground="{DynamicResource FloatBarForeground}" FontSize="13" VerticalAlignment="Center" />
                                                    <Viewbox Height="25">
                                                        <ui:ToggleSwitch Name="ToggleSwitchDrawShapeBorderAutoHide" Foreground="{DynamicResource FloatBarForeground}" FontFamily="Microsoft YaHei UI" Width="70" OnContent="开" OffContent="关" IsOn="True" />
                                                    </Viewbox>
                                                </ui:SimpleStackPanel>
                                            </ui:SimpleStackPanel>
                                            <ui:SimpleStackPanel Height="50" Spacing="14" Orientation="Horizontal">
                                                <Image Name="ImageDrawLine" Margin="16,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawLine_Click" Source="{DynamicResource DrawShapeImageSource.Line}" />
                                                <Image Name="ImageDrawDashedLine" Margin="0,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawDashedLine_Click" Source="{DynamicResource DrawShapeImageSource.DashedLine}" />
                                                <Image Name="ImageDrawDotLine" Margin="0,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawDotLine_Click" Source="{DynamicResource DrawShapeImageSource.DotLine}" />
                                                <Image Name="ImageDrawArrow" Margin="0,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawArrow_Click" Source="{DynamicResource DrawShapeImageSource.ArrowLine}" />
                                                <Image Name="ImageDrawParallelLine" Margin="0,11.5,16,11.5" MouseDown="Image_MouseDown" MouseUp="BtnDrawParallelLine_Click" Source="{DynamicResource DrawShapeImageSource.ParallelLine}" />
                                            </ui:SimpleStackPanel>
                                            <ui:SimpleStackPanel Height="50" Spacing="15" Orientation="Horizontal">
                                                <Image Margin="16,12,0,12" MouseUp="BtnDrawCoordinate1_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate1}" />
                                                <Image Margin="0,12" MouseUp="BtnDrawCoordinate2_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate2}" />
                                                <Image Margin="0,12" MouseUp="BtnDrawCoordinate3_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate3}" />
                                                <Image Margin="0,12" MouseUp="BtnDrawCoordinate4_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate4}" />
                                                <Image Margin="-1,11.5" MouseUp="BtnDrawCoordinate5_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate5}" />
                                            </ui:SimpleStackPanel>
                                            <ui:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                                <Image Margin="16,11,2,11" MouseUp="BtnDrawRectangleCenter_Click" Source="{DynamicResource DrawShapeImageSource.RectangleCenter}" />
                                                <Image Visibility="Collapsed" Margin="0,10" MouseUp="BtnDrawEllipse_Click" Source="{DynamicResource DrawShapeImageSource.Ellipse}" />
                                                <Image Margin="0,10" MouseUp="BtnDrawCircle_Click" Source="{DynamicResource DrawShapeImageSource.Circle}" />
                                                <Image Margin="0,10" MouseUp="BtnDrawDashedCircle_Click" Source="{DynamicResource DrawShapeImageSource.DashedCircle}" />
                                                <Image Margin="0,10" MouseUp="BtnDrawCenterEllipse_Click" Source="{DynamicResource DrawShapeImageSource.EllipseCenter}" Width="30" />
                                                <Image Margin="0,10" MouseUp="BtnDrawCenterEllipseWithFocalPoint_Click" Source="{DynamicResource DrawShapeImageSource.EllipseCenterWithFocalPoint}" Width="30" />
                                            </ui:SimpleStackPanel>
                                            <ui:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                                <Image Margin="16,10,2,10" MouseUp="BtnDrawHyperbola_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.Hyperbola}" />
                                                <Image Margin="4,10,2,10" MouseUp="BtnDrawHyperbolaWithFocalPoint_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.HyperbolaWithFocalPoint}" />
                                                <Image Margin="2.5,10,2,10" MouseUp="BtnDrawParabola1_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.Parabola}" />
                                                <Image Margin="1,10,2,10" MouseUp="BtnDrawParabolaWithFocalPoint_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.ParabolaWithFocalPoint}" RenderTransformOrigin="0.5,0.5">
                                                    <Image.RenderTransform>
                                                        <TransformGroup>
                                                            <ScaleTransform />
                                                            <SkewTransform />
                                                            <RotateTransform Angle="90" />
                                                            <TranslateTransform />
                                                        </TransformGroup>
                                                    </Image.RenderTransform>
                                                </Image>
                                                <Image Margin="2,10,2,10" MouseUp="BtnDrawParabola2_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.Parabola}" RenderTransformOrigin="0.5,0.5">
                                                    <Image.RenderTransform>
                                                        <TransformGroup>
                                                            <ScaleTransform />
                                                            <SkewTransform />
                                                            <RotateTransform Angle="90" />
                                                            <TranslateTransform />
                                                        </TransformGroup>
                                                    </Image.RenderTransform>
                                                </Image>
                                            </ui:SimpleStackPanel>
                                            <ui:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                                <Image Margin="15,11,2,11" MouseUp="BtnDrawRectangle_Click" Source="{DynamicResource DrawShapeImageSource.Rectangle}" />
                                                <Image Margin="6,10,2,10" MouseUp="BtnDrawCylinder_Click" Source="{DynamicResource DrawShapeImageSource.Cylinder}" />
                                                <Image Margin="8,12.5,0,10" MouseUp="BtnDrawCone_Click" Source="{DynamicResource DrawShapeImageSource.Cone}" />
                                                <Image Margin="5.5,12.5,2.5,10" MouseUp="BtnDrawCuboid_Click" Source="{DynamicResource DrawShapeImageSource.Cuboid}" />
                                                <Image Visibility="Collapsed" Margin="0,11.5,2.5,9.5" MouseUp="BtnDrawCuboid_Click" Source="{DynamicResource DrawShapeImageSource.Tetrahedron}" />
                                            </ui:SimpleStackPanel>
                                        </ui:SimpleStackPanel>
                                    </Viewbox>
                                </Border>
                            </Grid>
                            <ui:SymbolIcon Symbol="Undo" Foreground="{DynamicResource FloatBarForeground}" Margin="0,0,-2,0"
                                           Opacity="{Binding ElementName=BtnUndo, Path=IsEnabled, Converter={StaticResource IsEnabledToOpacityConverter}}"
                                           IsEnabled="{Binding ElementName=BtnUndo, Path=IsEnabled}"
                                           MouseUp="SymbolIconUndo_MouseUp" MouseDown="Border_MouseDown" />
                            <ui:SymbolIcon Symbol="Redo" Foreground="{DynamicResource FloatBarForeground}" Margin="-2,0,0,0"
                                           Opacity="{Binding ElementName=BtnRedo, Path=IsEnabled, Converter={StaticResource IsEnabledToOpacityConverter}}"
                                           IsEnabled="{Binding ElementName=BtnRedo, Path=IsEnabled}"
                                           MouseUp="SymbolIconRedo_MouseUp" MouseDown="Border_MouseDown" />
                            <ui:SymbolIcon x:Name="LockSmithSymbol"
                                           Symbol="Pin" Foreground="{DynamicResource FloatBarForeground}" Margin="-2,0,0,0"
                                           MouseUp="SymbolIconPin_MouseUp" MouseDown="Border_MouseDown" />
                        </ui:SimpleStackPanel>
                        <ui:SimpleStackPanel Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                            <Grid Width="20" Height="24" Margin="2,0,12,1">
                                <Image Margin="-8" MouseDown="Border_MouseDown" MouseUp="ImageBlackboard_MouseUp">
                                    <Image.Source>
                                        <DrawingImage>
                                            <DrawingImage.Drawing>
                                                <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                                    <DrawingGroup Opacity="1">
                                                        <GeometryDrawing Brush="{DynamicResource FloatBarForeground}" Geometry="F1 M64,64z M0,0z M15.125,48.875L15.125,17.375 21.875,17.375 21.875,15.125 24.125,15.125 24.125,17.375 39.875,17.375 39.875,15.125 42.125,15.125 42.125,17.375 48.875,17.375 48.875,48.875 M46.625,46.625L46.625,26.375 17.375,26.375 17.375,46.625 M17.375,24.125L46.625,24.125 46.625,19.625 42.125,19.625 42.125,21.875 39.875,21.875 39.875,19.625 24.125,19.625 24.125,21.875 21.875,21.875 21.875,19.625 17.375,19.625 17.375,24.125z" />
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingImage.Drawing>
                                        </DrawingImage>
                                    </Image.Source>
                                </Image>
                            </Grid>
                            <Grid Margin="0,5,0,5" Visibility="{Binding ElementName=StackPanelPPTButtons, Path=Visibility}">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.PPTExitNormal}" Visibility="{Binding ElementName=BtnPPTSlideShowEnd, Path=Visibility}" MouseDown="Border_MouseDown" MouseUp="ImagePPTControlEnd_MouseUp" Margin="-2,1,10,2" />
                            </Grid>
                            <ui:SimpleStackPanel Margin="0,5,10,5" Spacing="10" Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                                <ui:SymbolIcon Margin="0,0,0,0" Symbol="Camera" Foreground="{DynamicResource FloatBarForeground}" MouseDown="Border_MouseDown" MouseUp="SymbolIconScreenshot_MouseUp" />
                                <Grid Height="24" Width="20">
                                    <ui:SymbolIcon Symbol="Repair" Foreground="{DynamicResource FloatBarForeground}" MouseDown="Border_MouseDown" MouseUp="SymbolIconTools_MouseUp" />
                                    <Border Name="BorderTools" Margin="37,-195,-140,-6" CornerRadius="18" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                                        <ui:SimpleStackPanel>
                                            <Label Content="快捷设置" FontSize="14" Foreground="{DynamicResource FloatBarForeground}"
                                                   HorizontalAlignment="Left" Margin="8,8" />
                                            <Viewbox Margin="12,0,0,0" Height="38" Width="100" HorizontalAlignment="Left" VerticalAlignment="Top">
                                                <ui:SimpleStackPanel>
                                                    <Label Margin="0,0,0,-2" Content="画笔粗细" Foreground="{DynamicResource FloatBarForeground}" FontSize="13" VerticalAlignment="Center" />
                                                    <StackPanel Orientation="Horizontal">
                                                        <Slider HorizontalAlignment="Left"
                                                                Minimum="1" Maximum="20"
                                                                Width="102"
                                                                IsSnapToTickEnabled="True" Value="{Binding ElementName=InkWidthSlider, Path=Value, Mode=TwoWay}"
                                                                TickFrequency="1" TickPlacement="Both" />
                                                        <TextBlock Text="{Binding Value, ElementName=InkWidthSlider, Mode=OneWay}"
                                                                   Foreground="{DynamicResource FloatBarForeground}"
                                                                   VerticalAlignment="Bottom" Margin="6,0,0,8"
                                                                   Width="15" FontSize="13" />
                                                    </StackPanel>
                                                </ui:SimpleStackPanel>
                                            </Viewbox>
                                            <Viewbox Margin="12,0,0,0" Height="32" Width="50" HorizontalAlignment="Left" VerticalAlignment="Top">
                                                <ui:SimpleStackPanel>
                                                    <Label Margin="0,0,0,-2" Content="墨迹识别" Foreground="{DynamicResource FloatBarForeground}" FontSize="13" VerticalAlignment="Center" />
                                                    <Viewbox Height="25">
                                                        <ui:ToggleSwitch Foreground="{DynamicResource FloatBarForeground}" FontFamily="Microsoft YaHei UI" Width="70" MinWidth="0" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableInkToShape_Toggled" IsOn="{Binding ElementName=ToggleSwitchEnableInkToShape, Path=IsOn}" />
                                                    </Viewbox>
                                                </ui:SimpleStackPanel>
                                            </Viewbox>
                                            <Viewbox Margin="0,-32,10,0" Height="32" Width="50" HorizontalAlignment="Right" VerticalAlignment="Top">
                                                <ui:SimpleStackPanel>
                                                    <Label Margin="0,0,0,-2" Content="手指模式" Foreground="{DynamicResource FloatBarForeground}" FontSize="13" VerticalAlignment="Center" />
                                                    <Viewbox Height="25">
                                                        <ui:ToggleSwitch Foreground="{DynamicResource FloatBarForeground}" IsOn="{Binding ElementName=ToggleSwitchModeFinger, Path=IsOn}" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" MinWidth="0" Width="70" />
                                                    </Viewbox>
                                                </ui:SimpleStackPanel>
                                            </Viewbox>
                                            <Label Content="墨迹" FontSize="14" Foreground="{DynamicResource FloatBarForeground}"
                                                   HorizontalAlignment="Left" Margin="8,8" />
                                            <ui:SimpleStackPanel Orientation="Horizontal" Margin="12,0,0,0" Spacing="11">
                                                <ui:SymbolIcon Symbol="Save" Foreground="{DynamicResource FloatBarForeground}" MouseDown="Border_MouseDown" MouseUp="SymbolIconSaveStrokes_MouseUp" />
                                                <ui:SymbolIcon Symbol="OpenFile" Foreground="{DynamicResource FloatBarForeground}" MouseDown="Border_MouseDown" MouseUp="SymbolIconOpenStrokes_MouseUp" />
                                                <Border Width="1" Height="20" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}" />
                                                <Grid MouseDown="Border_MouseDown" MouseUp="GridInkReplayButton_MouseUp">
                                                    <ui:SymbolIcon Symbol="Edit" Foreground="{DynamicResource FloatBarForeground}" />
                                                    <Image Source="{DynamicResource AndroidRefreshDrawingImage}" VerticalAlignment="Bottom" HorizontalAlignment="Right"
                                                           Margin="0,0,-3,-3" Width="11">
                                                    </Image>
                                                </Grid>
                                            </ui:SimpleStackPanel>
                                            <Label Content="工具" FontSize="14" Foreground="{DynamicResource FloatBarForeground}"
                                                   HorizontalAlignment="Left" Margin="8,8" />
                                            <ui:SimpleStackPanel Margin="12,0,0,0" Spacing="11" Orientation="Horizontal">
                                                <Grid Width="20" Height="24" Margin="0,0,0,2">
                                                    <Image Margin="-7" MouseDown="Border_MouseDown" MouseUp="ImageCountdownTimer_MouseUp">
                                                        <Image.Source>
                                                            <DrawingImage>
                                                                <DrawingImage.Drawing>
                                                                    <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                                                        <DrawingGroup Opacity="1">
                                                                            <GeometryDrawing Brush="{DynamicResource FloatBarForeground}" Geometry="F1 M64,64z M0,0z M42.811,22.789C44.393,24.383 45.612,26.126 46.467,28.018 47.322,29.91 47.75,31.988 47.75,34.249 47.75,35.702 47.562,37.1 47.188,38.441 46.814,39.782 46.283,41.037 45.597,42.203 44.911,43.369 44.091,44.43 43.136,45.385 42.181,46.34 41.12,47.16 39.954,47.846 38.788,48.532 37.534,49.062 36.192,49.437 34.85,49.812 33.453,50 32,50 30.547,50 29.149,49.812 27.808,49.438 26.467,49.064 25.212,48.533 24.046,47.847 22.88,47.161 21.819,46.341 20.864,45.386 19.909,44.431 19.089,43.37 18.403,42.204 17.717,41.038 17.187,39.784 16.812,38.442 16.437,37.1 16.25,35.703 16.25,34.25 16.25,32.949 16.405,31.684 16.716,30.453 17.027,29.222 17.466,28.062 18.034,26.973 18.602,25.884 19.291,24.872 20.099,23.941 20.907,23.01 21.81,22.183 22.806,21.462 23.802,20.741 24.886,20.141 26.058,19.66 27.23,19.179 28.46,18.846 29.749,18.658L29.749,16.25 25.249,16.25 25.249,14 36.5,14 36.5,16.25 32,16.25 32,18.5C33.629,18.5 35.214,18.74 36.755,19.221 38.296,19.702 39.729,20.416 41.053,21.366L44.709,17.71 46.291,19.292 42.811,22.789z M32,47.75C33.863,47.75 35.612,47.396 37.247,46.687 38.882,45.978 40.311,45.011 41.536,43.787 42.761,42.563 43.727,41.133 44.436,39.498 45.145,37.863 45.5,36.113 45.5,34.25 45.5,32.387 45.146,30.638 44.437,29.003 43.728,27.368 42.761,25.939 41.537,24.714 40.313,23.489 38.883,22.523 37.248,21.814 35.613,21.105 33.863,20.75 32,20.75 30.137,20.75 28.388,21.104 26.753,21.813 25.118,22.522 23.689,23.489 22.464,24.713 21.239,25.937 20.273,27.367 19.564,29.002 18.855,30.637 18.5,32.387 18.5,34.25 18.5,36.113 18.854,37.862 19.563,39.497 20.272,41.132 21.239,42.561 22.463,43.786 23.687,45.011 25.117,45.977 26.752,46.686 28.387,47.395 30.137,47.75 32,47.75z M38.75,34.25L38.75,36.5 29.75,36.5 29.75,25.25 32,25.25 32,34.25 38.75,34.25z" />
                                                                        </DrawingGroup>
                                                                    </DrawingGroup>
                                                                </DrawingImage.Drawing>
                                                            </DrawingImage>
                                                        </Image.Source>
                                                    </Image>
                                                </Grid>
                                                <Border Width="1" Height="20" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}" />
                                                <ui:SymbolIcon Symbol="Shuffle" Foreground="{DynamicResource FloatBarForeground}" MouseDown="Border_MouseDown" MouseUp="SymbolIconRand_MouseUp" />
                                                <Grid MouseUp="SymbolIconRandOne_MouseUp" MouseDown="Border_MouseDown">
                                                    <ui:SymbolIcon Symbol="Shuffle" Foreground="{DynamicResource FloatBarForeground}" />
                                                    <Border CornerRadius="50" BorderBrush="{DynamicResource FloatBarForeground}" BorderThickness="1"
                                                            HorizontalAlignment="Center" Margin="-2,0,0,-2" VerticalAlignment="Bottom" Height="9" Width="9">
                                                        <TextBlock Text="1" FontSize="7" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,-0.8,0,0" Foreground="{DynamicResource FloatBarForeground}" />
                                                    </Border>
                                                </Grid>
                                            </ui:SimpleStackPanel>
                                        </ui:SimpleStackPanel>
                                    </Border>
                                </Grid>
                            </ui:SimpleStackPanel>
                        </ui:SimpleStackPanel>
                    </ui:SimpleStackPanel>
                </Border>
            </ui:SimpleStackPanel>
        </Viewbox>
        <Grid Name="GridForFloatingBarDraging" Background="#01000000" Visibility="Collapsed"
              MouseMove="SymbolIconEmoji_MouseMove" MouseUp="SymbolIconEmoji_MouseUp" />
        <InkCanvas Name="InkCanvasForInkReplay" MouseDown="InkCanvasForInkReplay_MouseDown" Visibility="Collapsed" EditingMode="None" Background="Transparent" />
    </Grid>

</Window>

